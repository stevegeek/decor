<% content_for :title, "CloudStack Pro - Dashboard" %>

<div class="container mx-auto px-4 py-6">
  <!-- Page Header -->
  <div class="mb-8">
    <%= render ::Decor::Title.new(text: "Dashboard", level: 1) %>
    <p class="text-gray-600 mt-2">Welcome back! Here's an overview of your cloud infrastructure.</p>
  </div>

  <!-- Metrics Cards Row -->
  <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
    <!-- Active Instances Card -->
    <%= render ::Decor::Card.new(color: :primary, size: :md) do |card| %>
      <div class="text-center">
        <%= render ::Decor::Icon.new(name: "server", html_options: {class: "mx-auto h-8 w-8 mb-2 text-primary"}) %>
        <div class="text-3xl font-bold text-primary"><%= @metrics[:active_instances] %></div>
        <div class="text-sm text-gray-600">Active Instances</div>
      </div>
    <% end %>

    <!-- CPU Usage Card -->
    <%= render ::Decor::Card.new(color: :info, size: :md) do |card| %>
      <div class="text-center">
        <%= render ::Decor::Icon.new(name: "cpu-chip", html_options: {class: "mx-auto h-8 w-8 mb-2 text-info"}) %>
        <div class="text-3xl font-bold text-info"><%= @metrics[:cpu_usage] %>%</div>
        <div class="text-sm text-gray-600">Avg CPU Usage</div>
      </div>
    <% end %>

    <!-- Memory Usage Card -->
    <%= render ::Decor::Card.new(color: :warning, size: :md) do |card| %>
      <div class="text-center">
        <%= render ::Decor::Icon.new(name: "circle-stack", html_options: {class: "mx-auto h-8 w-8 mb-2 text-warning"}) %>
        <div class="text-3xl font-bold text-warning"><%= @metrics[:memory_usage] %>%</div>
        <div class="text-sm text-gray-600">Avg Memory Usage</div>
      </div>
    <% end %>

    <!-- Monthly Cost Card -->
    <%= render ::Decor::Card.new(color: :success, size: :md) do |card| %>
      <div class="text-center">
        <%= render ::Decor::Icon.new(name: "currency-dollar", html_options: {class: "mx-auto h-8 w-8 mb-2 text-success"}) %>
        <div class="text-3xl font-bold text-success">$<%= @metrics[:monthly_cost] %></div>
        <div class="text-sm text-gray-600">This Month</div>
      </div>
    <% end %>
  </div>

  <!-- Main Content Grid -->
  <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
    <!-- Recent Activity -->
    <div class="lg:col-span-2">
      <%= render ::Decor::Card.new(title: "Recent Activity", size: :lg) do |card| %>
        <div class="space-y-4">
          <% @recent_activities.each do |activity| %>
            <div class="flex items-center space-x-3 p-3 rounded-lg hover:bg-gray-50">
              <%= render ::Decor::Icon.new(name: "clock", html_options: {class: "h-5 w-5 text-gray-400"}) %>
              <div class="flex-1">
                <div class="text-sm font-medium"><%= activity[:action] %></div>
                <div class="text-sm text-gray-600"><%= activity[:instance] %></div>
              </div>
              <div class="text-xs text-gray-500"><%= activity[:time] %></div>
            </div>
          <% end %>
        </div>
        <div class="mt-4 pt-4 border-t">
          <%= render ::Decor::Link.new(href: cloudstack_instances_path, text: "View all activity â†’") %>
        </div>
      <% end %>
    </div>

    <!-- Quick Actions -->
    <div>
      <%= render ::Decor::Card.new(title: "Quick Actions", size: :lg) do |card| %>
        <div class="space-y-3">
          <%= render ::Decor::Button.new(
            label: "Launch Instance",
            color: :primary,
            icon: "plus",
            full_width: true,
            element_tag: :a
          ) %>
          
          <%= render ::Decor::Button.new(
            label: "View Instances",
            color: :secondary,
            variant: :outlined,
            icon: "server",
            full_width: true,
            element_tag: :a
          ) %>
          
          <%= render ::Decor::Button.new(
            label: "Billing & Usage",
            color: :neutral,
            variant: :outlined,
            icon: "chart-bar",
            full_width: true,
            element_tag: :a
          ) %>
          
          <%= render ::Decor::Button.new(
            label: "Support Center",
            color: :info,
            variant: :text,
            icon: "question-mark-circle",
            full_width: true,
            element_tag: :a
          ) %>
        </div>
      <% end %>
    </div>
  </div>

  <!-- System Status Banner -->
  <div class="mt-8">
    <%= render ::Decor::Banner.new(
      color: :success,
      variant: :filled,
      dismissible: false
    ) do %>
      <%= render ::Decor::Icon.new(name: "check-circle", html_options: {class: "h-5 w-5 mr-2"}) %>
      All systems operational. Last updated: <%= Time.current.strftime("%B %d, %Y at %I:%M %p") %>
    <% end %>
  </div>
</div>